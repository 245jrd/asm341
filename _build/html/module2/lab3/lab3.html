<!DOCTYPE html>
<head>
  
  <!--STAGING:-->
  <script src="https://assets.adobedtm.com/50164577268f481934e5d57dbfb78f929164cd0d/satelliteLib-ea775cfabef5fca8b04e9392f20c986c0724a7c3-staging.js"></script>
  <!--Production:-->
  <script src="https://assets.adobedtm.com/50164577268f481934e5d57dbfb78f929164cd0d/satelliteLib-ea775cfabef5fca8b04e9392f20c986c0724a7c3.js"></script>
    <title>Lab 2.3: Credential Stuffing</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="kb_doc_type" content="Manual"/>
  <meta name="kb_doc_type" content="User Guide"/>
  <meta name="title" content="Lab 2.3: Credential Stuffing"/>
  <meta name="product" content="Agility 2018 ASM 341"/>
  <meta name="version" content="1.0"/>
  <meta name="updated_date"  content="None"/>
  <meta name="archived" content="Archived documents excluded"/>

  
  
  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">
 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script type="text"> jQuery.noConflict(true)</script>

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Lab 2.3: Credential Stuffing &#8212; Agility 2018 ASM 341 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab 2.4: Data Guard" href="../lab4/lab4.html" />
    <link rel="prev" title="Lab 2.2: Session Hijacking Protection" href="../lab2/lab2.html" />
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="dismiss">
      <button type="button" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>
    </div>
    <div id="sidebar" class="section-nav">
      <nav class="nav-sidebartoc">
        <h5>Agility 2018 ASM 341 1.0 documentation 1.0</h5>
<div id="searchbox" role="search">
  <form class="search" action="../../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <h5>Current Page</h5>
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Lab 2.3: Credential Stuffing</a><ul>
<li><a class="reference internal" href="#task-1-configure-credential-stuffing-detection">Task 1 - Configure Credential Stuffing Detection</a></li>
<li><a class="reference internal" href="#task-2-test-credential-stuffing-detection">Task 2 - Test Credential Stuffing Detection</a></li>
</ul>
</li>
</ul>

         </span>
        <hr>
        <h5>Site Contents</h5>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Welcome to Agility Labs 2018!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../labinfo/labinfo.html">Lab Topology &amp; Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../module1/module1.html">Module 1: Positive Security</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../module2.html">Module 2: Beyond Signatures and Positive Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../lab1/lab1.html">Lab 2.1: User Session Tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab2/lab2.html">Lab 2.2: Session Hijacking Protection</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Lab 2.3: Credential Stuffing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab4/lab4.html">Lab 2.4: Data Guard</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lab5/lab5.html">Lab 2.5: DAST Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../module3/module3.html">Module 3: Advanced WAF</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>

  
  <div class="main active" id="content">
    <article class="docs-container site-article-inner">
            <nav class="site-breadcrumb-nav site-nav">
          <ul class="site-breadcrumb-list">
            <li class="breadcrumb-item"><button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>&#x20 <a href="/">Agility 2018</a> &gt; <a href="../../index.html">Agility 2018 ASM 341 </a> &gt; Lab 2.3: Credential Stuffing</li>
          </ul>
      </nav>
      
      

    
  <div class="section" id="lab-2-3-credential-stuffing">
<h1>Lab 2.3: Credential Stuffing<a class="headerlink" href="#lab-2-3-credential-stuffing" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Items in this section depend on steps in prior sections, please ensure you’ve completed all sections in lab 2 up to this point before beginning this lab.</p>
</div>
<div class="section" id="task-1-configure-credential-stuffing-detection">
<h2>Task 1 - Configure Credential Stuffing Detection<a class="headerlink" href="#task-1-configure-credential-stuffing-detection" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Open the BIG-IP interface in Firefox.</p>
</li>
<li><p class="first">Navigate to <strong>Security -&gt; Application Security -&gt; Anomaly Detection -&gt; Brute Force</strong> and click <strong>Create</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ASM has a number of brute force attack detection capabilities that are beyond the scope of this exercise.  Take some time to examine some of the other options as you work through this lab.  For more information see:  <code class="docutils literal notranslate"><span class="pre">https://support.f5.com/kb/en-us/products/big-ip_asm/manuals/product/asm-implementations-13-1-0/6.html</span></code></p>
</div>
</li>
<li><p class="first">Select the login page we created in Lab 2.1.</p>
<p><img alt="lab23-1" src="../../_images/lab23-1.png" /></p>
</li>
<li><p class="first">Configure <strong>Credential Stuffing</strong> detection within the <strong>Distributed Brute Force</strong> Section as follows:</p>
<p><img alt="lab23-3" src="../../_images/lab23-3.png" /></p>
</li>
<li><p class="first">Click <strong>Create</strong>.</p>
</li>
<li><p class="first">Click <strong>Apply Policy</strong>, then click <strong>OK</strong></p>
</li>
</ol>
</div>
<div class="section" id="task-2-test-credential-stuffing-detection">
<h2>Task 2 - Test Credential Stuffing Detection<a class="headerlink" href="#task-2-test-credential-stuffing-detection" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Open a new Private Browsing window in <strong>Firefox</strong>.</p>
</li>
<li><p class="first">Go to the to WebGoat login page at <code class="docutils literal notranslate"><span class="pre">http://10.1.10.145/WebGoat/login</span></code> but <strong>do not login as f5student</strong></p>
</li>
<li><p class="first">Attempt to login using the username <code class="docutils literal notranslate"><span class="pre">demo33&#64;fidnet.com</span></code> and password <code class="docutils literal notranslate"><span class="pre">mountainman01</span></code>.  On the second attempt, you should immediately be challenged via CAPTCHA because this username/password combination is present in the credential stuffing database.</p>
</li>
<li><p class="first"><strong>Solve</strong> the CAPTCHA(s) and continue.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Credential stuffing is a type of brute force attack that leverages stolen credentials from another source.  This source is most commonly the breach of a widley used online service.  These leaked credentials are then levered in an attempt to compromise higher value targets in instances where users used the same credentials across multiple services.  BIG-IP now has the capability to detect these types of attacks by employing a database of credentials that are known to have been compromised in a previous breach.  The credentials are stored as one-way hashed usernames and passwords to protect them from further disclosure.  Also note that we’ve chosen CAPTCHA as mitigation for this lab because it provides immediate feedback to the student.  In a production environment, Client Side Integrity Defense (or both), may be a more effective form of mitigation during an actual attack.  Feel free to experiment with this in the lab.</p>
</div>
</li>
<li><p class="first">Examine the most recent <strong>illegal</strong> request in the event log:</p>
<p><img alt="lab23-4" src="../../_images/lab23-4.png" /></p>
<p>Take note of the username field.  The request was blocked as a brute force attack.</p>
</li>
<li><p class="first">Click the <strong>Brute force: Maximum Login Attempts are exceeded</strong> header at the top of the event window:</p>
<p><img alt="lab23-5" src="../../_images/lab23-5.png" /></p>
<p>The message indicates the number of login attempts that matched the internal database.</p>
</li>
<li><p class="first">Now check out the reporting under <strong>Event Logs -&gt; Application -&gt; Brute Force Attacks</strong>:</p>
<p><img alt="lab23-6" src="../../_images/lab23-6.png" /></p>
</li>
<li><p class="first">Click on one of the attack entries to get some more detail about the attack:</p>
<p><img alt="lab23-7" src="../../_images/lab23-7.png" /></p>
</li>
<li><p class="first">For fun, head over to <code class="docutils literal notranslate"><span class="pre">https://haveibeenpwned.com/</span></code> and put in the email address of the account we used in the lab to get some details.  It may also be interesting to put in your own account(s) to see if any of your credentials have been breached.  You could also try some of your old username/password combinations against the credential stuffing database on the F5.  While on the main page explore some of the breach data on the bottom to get a sense of how big this problem is.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The credential stuffing feature is considered Early Access in version 13.1 and the database is not yet being updated regularly.  You are advised to seek guidance from your F5 SE before deploying this capability.</p>
</div>
</li>
<li><p class="first">In order to release any blocking that’s currently in place, navigate to <strong>Security -&gt; Application Security -&gt; Anomaly Detection -&gt; Brute Force</strong> and <strong>delete</strong> the Brute Force configuration we created previously.</p>
</li>
<li><p class="first">Click <strong>Apply Policy</strong> then click <strong>OK</strong>.</p>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>This concludes section 3.</strong></p>
</div>
</div>



    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="../lab2/lab2.html" title="Lab 2.2: Session Hijacking Protection" accesskey="p" class="btn btn-primary pull-left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../lab4/lab4.html" title="Lab 2.4: Data Guard" accesskey="n" class="btn btn-primary pull-right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    jQuery.noConflict(true)
  </script>
  <script src="../../_static/js/clouddocs.js"></script>
  </body>
</html>